- hosts: test
  become: true
  gather_facts: false
  vars_files:
       - secrets.yml
  vars:
    ansible_python_interpreter: /usr/bin/python
    destination: "/home/node/satswala-mono"

  tasks:

    - git:
        repo: "https://{{gituser}}:{{gitpass}}@gitlab.com/stackmate/satswala-mono.git"
        dest: "{{ destination }}"

    - file: 
        path: /home/node/satswala-mono
        state: directory
        owner: sushi
        group: sushi
        mode: 0770
        recurse: yes
    - file: 
        path: /home/node/satswala-mono/app/typescript
        state: directory
        owner: node
        mode: 0770
        recurse: yes
    - file: 
        path: /home/node/satswala-mono/app/typescript/src/services/core/admin/public
        state: directory
        owner: node
        mode: 0777
        recurse: yes
    
    - file: 
        path: /home/node/satswala-mono/infra/mongo
        state: directory
        owner: mongodb
        mode: 0770
        recurse: yes
    - file: 
        path: /home/node/satswala-mono/infra/nginx
        state: directory
        owner: nginx
        mode: 0770
        recurse: yes
    - file: 
        path: /home/node/satswala-mono/infra/bitcoin
        state: directory
        owner: bitcoin
        mode: 0770
        recurse: yes
      